AWSTemplateFormatVersion: '2010-09-09'
Description: Snapper Go application to take snapshot of volumes.
Resources:
  Snapper:
    Properties:
      CodeUri: s3://vatit-lambdas/a2d96725b092db59f113ece941f2c3dd
      Description: Takes snapshots of instance volumes.
      Environment:
        Variables:
          OPTION: create
      Events:
        CreateSnapshot:
          Properties:
            Input: "{\n  \"option\": \"create\",\n  \"keep\": \"\"\n}\n"
            Schedule: cron(0 2 ? * MON-FRI *)
          Type: Schedule
        DeleteSnapshot7Days:
          Properties:
            Input: "{\n  \"option\": \"delete\",\n  \"keep\": \"7\"\n}\n"
            Schedule: cron(0 2 ? * MON-FRI *)
          Type: Schedule
      FunctionName: snapper-go
      Handler: main
      Role: arn:aws:iam::197094583576:role/snapper
      Runtime: go1.x
      Timeout: 15
    Type: AWS::Serverless::Function
Transform: AWS::Serverless-2016-10-31
